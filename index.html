<!DOCTYPE html>
<html lang="en" style="margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.28.0a3/full/pyodide.js"></script>
    <!-- Three.js library for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- TODO: delete stl loader if it is still not used later -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/libs/fflate.module.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/3MFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <link rel="stylesheet" href="style.css">
    <script>
        // Tailwind config for custom colors and animations
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f4ff',
                            500: '#667eea',
                            600: '#5a67d8',
                            700: '#4c51bf'
                        }
                    },
                    animation: {
                        'slide-in': 'slideIn 0.3s ease-out',
                        'fade-in': 'fadeIn 0.5s ease-out'
                    },
                    keyframes: {
                        slideIn: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(0)' }
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-900 text-white overflow-hidden" style="margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;">
    <!-- Full-screen 3D Container -->
    <div id="three-container" class="fixed inset-0 w-screen h-screen bg-gray-900 overflow-hidden" style="position: fixed !important; top: 0 !important; left: 0 !important; width: 100vw !important; height: 100vh !important; z-index: 0 !important; background: #111827 !important;">
        <div id="viewer-placeholder" class="absolute inset-0 flex items-center justify-center">
            <div class="text-center text-gray-400">
                <div class="text-6xl mb-4 animate-pulse">üéØ</div>
                <p class="text-xl mb-2">Your 3D model will appear here</p>
                <p class="text-sm opacity-75">Configure parameters and click "Generate Model"</p>
                <p class="text-xs opacity-60 mt-3">‚ö†Ô∏è Note: Initial loading can take 10-30 seconds</p>
            </div>
        </div>
    </div>

    <!-- Floating Sidebar -->
    <div class="fixed left-3 top-3 bottom-3 w-80 flex flex-col animate-slide-in z-50 lg:translate-x-0 -translate-x-full transition-transform duration-300 ease-in-out">
        <!-- Main Sidebar Panel -->
        <div class="bg-white/10 backdrop-blur-xl border border-white/20 text-white rounded-xl shadow-2xl flex flex-col h-full overflow-hidden">
            <!-- Header -->
            <div class="p-5 bg-gradient-to-r from-blue-600/20 to-purple-600/20 border-b border-white/10">
                <div>
                    <h1 class="text-lg font-bold text-white">Model Generator</h1>
                    <p class="text-xs text-white/70">Parametric 3D Design</p>
                </div>
            </div>

            <!-- Parameters Section -->
            <div class="flex-1 p-4 overflow-y-auto">
                <div class="space-y-4">
                    <!-- Parameters Header -->
                    <div class="mb-4 flex items-center justify-between">
                        <h2 class="text-base font-semibold text-white">Parameters</h2>
                        <button id="reload-params" 
                            class="text-xs text-white/70 hover:text-white font-medium px-2 py-1 rounded hover:bg-white/10 transition-all duration-200 flex items-center space-x-1"
                            title="Reload parameter definitions from generate.py">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            <span>Reload</span>
                        </button>
                    </div>
                    
                    <!-- Dynamic Parameter Inputs (generated by JavaScript) -->
                    <div class="space-y-3">
                        <div class="text-xs text-white/60 text-center py-8">
                            Loading parameters...
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <div class="pt-3">
                        <button id="run-code" disabled
                            class="w-full py-3 px-5 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg border border-white/20 backdrop-blur-sm">
                            <span id="run-text" class="flex items-center justify-center">
                                Loading Pyodide...
                            </span>
                        </button>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex space-x-2 pt-2">
                        <button id="download-stl" disabled
                            class="flex-1 py-2 px-3 bg-gradient-to-r from-green-600/80 to-emerald-600/80 hover:from-green-700/90 hover:to-emerald-700/90 border border-white/20 text-white font-medium rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-xs backdrop-blur-sm">
                            Download STL
                        </button>
                        <button id="reset-view" disabled
                            class="flex-1 py-2 px-3 bg-gradient-to-r from-slate-600/80 to-gray-600/80 hover:from-slate-700/90 hover:to-gray-700/90 border border-white/20 text-white font-medium rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-xs backdrop-blur-sm">
                            Reset View
                        </button>
                    </div>
                </div>
            </div>

            <!-- Console Output Section -->
            <div id="console-section" class="border-t border-white/10 bg-gradient-to-b from-black/10 to-black/30 backdrop-blur-sm">
                <div class="p-3">
                    <!-- Resize Handle -->
                    <div id="resize-handle" 
                        class="w-full h-2 bg-white/20 rounded cursor-ns-resize hover:bg-white/40 transition-colors duration-200 mb-3 flex items-center justify-center"
                        title="Drag to resize console">
                        <div class="w-12 h-1 bg-white/50 rounded"></div>
                    </div>
                    
                    <!-- Console Tabs -->
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-1">
                            <button id="js-console-tab" 
                                class="console-tab active text-xs font-semibold px-2 py-1 rounded transition-all duration-200"
                                title="JavaScript Console">
                                JS
                            </button>
                            <button id="python-console-tab" 
                                class="console-tab text-xs font-semibold px-2 py-1 rounded transition-all duration-200"
                                title="Python Console">
                                Python
                            </button>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button id="expand-console" 
                                class="text-xs text-white/70 hover:text-white font-medium px-2 py-1 rounded hover:bg-white/10 transition-all duration-200 flex items-center space-x-1"
                                title="Show/Hide Console">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 10l-5 5-5-5"></path>
                                </svg>
                                <span>Hide</span>
                            </button>
                            <button id="clear-output" 
                                class="text-xs text-white/70 hover:text-white font-medium px-2 py-1 rounded hover:bg-white/10 transition-all duration-200">
                                Clear
                            </button>
                        </div>
                    </div>
                    
                    <!-- JavaScript Console -->
                    <div id="js-output" 
                        class="console-content bg-black/40 text-green-400 p-2 rounded-lg font-mono text-xs overflow-y-auto border border-white/10 backdrop-blur-sm resize-none"
                        style="height: 200px; min-height: 80px; max-height: 400px;">
                    </div>
                    
                    <!-- Python Console -->
                    <div id="python-output" 
                        class="console-content hidden bg-black/40 text-blue-400 p-2 rounded-lg font-mono text-xs overflow-y-auto border border-white/10 backdrop-blur-sm resize-none"
                        style="height: 200px; min-height: 80px; max-height: 400px;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar (bottom right) -->
    <div class="fixed bottom-4 right-4 z-40">
        <div class="bg-gradient-to-r from-slate-800/80 to-gray-800/80 backdrop-blur-xl border border-white/20 text-white px-4 py-2 rounded-xl shadow-lg">
            <span id="status" class="text-xs font-medium">Initializing Python environment...</span>
        </div>
    </div>

    <!-- Mobile Toggle Button (hidden on desktop) -->
    <button id="mobile-toggle" class="fixed top-4 left-4 z-50 lg:hidden bg-gradient-to-r from-blue-600/80 to-purple-600/80 backdrop-blur-xl border border-white/20 p-2 rounded-xl shadow-lg">
        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>

    <script src="script.js"></script>
</body>
</html> 
